# annotate_dataset ✍️

The `annotate_dataset` module is part of the **Balatro** project.
It helps you **organize and label the dataset of card images** captured with `build_dataset`.
This module allows you to correctly group cards, assign labels, and prepare clean training data for AI.

---

## 🚀 Features

* Load screenshots generated by `build_dataset`
* Organize cards into the correct groups
* Assign labels to each card
* Save annotations in structured JSON format
* Streamlit-based annotation interface
* Can use inference from pre-trained model to pre-fill data

---

## 🛠 Installation

Make sure you are inside the Balatro project folder and dependencies are installed:

```bash
pip install -r requirements.txt
```

Move the desired cards from the `data/screenshots` to the `data/dataset_default` folder.

---

## 🎯 Usage

### 1️⃣ (Optional) Use pre-trained model to make inference
This saves the inference.json with the predictions of the pre-trained model. Usually this step is done after having already trained a simple model and more data is required to train a better model.
```bash
python -m utils.inference_utils --img-dir "data/dataset_default" --task-name identification --topk 2 --out-json "data/dataset_default/inference.json" --checkpoint "data/models/best_model.pth"
```

### 2️⃣ Annotate the dataset
This launches the annotation interface in your browser:

```bash
python -m streamlit run annotate_dataset/main.py
```

Follow the on-screen interface to:

1. View card groups and individual cards.
2. Label cards with name, type, rarity, and modifier.
3. Save your annotations. All labels are stored in a JSON file (`data/dataset_default/labels.json`) ready for training.

### 3️⃣ (Optional) Verify the dataset

Verify the annotations

After finishing the labeling process, you can launch the verification page to quickly review that all cards have been grouped and labeled correctly:

```bash
streamlit run annotate_dataset/verify_labels.py
```

This page displays:
* All cards grouped by name and modifier
* Each group’s type and rarity in the title
* Compact rows of thumbnails (small card previews)
* Quick spotting of mislabels, duplicates, or missing images
---

## 📌 Notes

* The Streamlit interface is recommended for labeling efficiency.
* Annotations are saved automatically upon pressing the **Save Labels** button.
* Helper selectboxes and auto-fill features are available for common card names.